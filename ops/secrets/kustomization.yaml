# Kustomize Configuration: External Secrets Resources
# This kustomization.yaml defines all External Secrets Operator resources for GitOps secrets management.
# It's deployed via ArgoCD Application (aks-rocketchat-secrets) which watches this directory.
# Resources include: ClusterSecretStore (Azure Key Vault auth) and ExternalSecrets (secret sync definitions).
# See VERSIONS.md for External Secrets Operator version tracking (managed by Helm chart via ArgoCD).
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  # ClusterSecretStore: Azure Key Vault authentication configuration
  - clustersecretstore-azure-keyvault.yaml  # ClusterSecretStore for Azure Key Vault (uses Azure Workload Identity)
  # ExternalSecrets: Secret sync definitions (sync secrets from Key Vault to Kubernetes)
  - externalsecret-mongodb-admin-password.yaml  # MongoDB admin password (for MongoDB Community Operator)
  - externalsecret-mongodb-rocketchat-password.yaml  # MongoDB rocketchat user password (for MongoDB Community Operator)
  - externalsecret-metrics-endpoint-password.yaml  # MongoDB metrics endpoint password (for MongoDB Community Operator)
  - externalsecret-mongodb-metrics-endpoint-password-monitoring.yaml  # Mirror MongoDB metrics password into monitoring namespace (Prometheus Agent scrape)
  - externalsecret-rocketchat-mongodb-external.yaml  # MongoDB connection strings (for Rocket.Chat Helm chart)
  - externalsecret-smtp-credentials.yaml  # SMTP password for Rocket.Chat (secret-backed SMTP config)
  - externalsecret-observability-credentials.yaml  # Observability credentials (for Prometheus Agent, OTel Collector, Promtail)
  - externalsecret-jenkins.yaml  # Jenkins credentials (admin login, GitHub token for CI validation)
